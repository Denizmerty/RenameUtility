This program may look like a solution looking for a problem, but it was actually a borne out of a very specific issue that I was facing, how does one "shift" a group of files with numerical suffixes at the end? If one wants to add a File5 to a group of files named from File1 to File25, how do you shift the existing File5 into File6, existing File6 into File7, existing File7 into File8 and so on? Surely one can open PowerShell and simply use a script like `for($i=<Max>;$i -ge <Min>;$i--){ren "<Directory>\<File>$i<Extension>" "<File>$($i+<Increment>)<Extension>"}`, but that is not exactly a safe method of doing it.

So, even though that PowerShell snippet gets the renaming order right for incrementing in a single line, it is pretty much a blunt instrument. My immediate concerns were about safety and precision: I needed ways to confirm the exact folder and file types, and to validate that the number ranges I was inputting were sensible. Then came the real world messiness: files weren't always consistently numbered. Sometimes it was `file1.pdf`, other times `File01.PDF`. A basic script couldn't gracefully handle such variations in padding or case, so the program needed the intelligence to parse these and generate uniformly formatted new names. The thought of blindly executing renames led naturally to requiring a preview feature : to see exactly what would happen *before* it happened. And for true peace of mind, a backup option for the entire directory seemed essential. The feature list just kept growing from there: what about more complex find-and-replace, different case conversions, or even working with a manually curated list of files instead of just directory scans? You get the idea, I realized that the requirements far exceeded what any manageable PowerShell script could offer(by that time I had a barely maintainable and readable 800 LoC .ps1 script that I hated using) and decided to create a proper full feature GUI program, and here we are.

# File Renamer Utility

**Version:** 1.0.0

File Renamer Utility is a comprehensive GUI application designed for batch renaming files with a rich set of features. It offers two main modes of operation: scanning a directory for files or manually selecting files. The utility provides powerful renaming capabilities through customizable patterns, find/replace, case conversion, and numeric sequencing, all while prioritizing safety with preview, backup, and undo functionalities.

## Core Functionality

The application allows users to:
*   Select files for renaming either by scanning a directory with filters or by adding files manually.
*   Define complex new naming patterns using various placeholders.
*   Perform find and replace operations on generated filenames.
*   Change the case of filenames.
*   Increment numbers found in filenames(primarily in Directory Scan mode).
*   Preview all proposed changes before applying them.
*   Create a backup of the source directory before renaming.
*   Undo the last successful rename operation.
*   Save and load renaming settings as profiles.

The UI is designed to be intuitive, with detailed logging available for all operations. Long-running tasks like previewing, renaming, and undoing are performed in background threads to keep the UI responsive.

## Features

### 1. Operation Modes

*   **Directory Scan:**
    *   **Target Directory:** Select a folder containing files to rename(type path, use selector, or drag & drop a folder).
    *   **Filename Pattern:** Specify a pattern to find files(e.g., `*.jpg`, `doc_???.txt`). Supports `*`(any characters) and `?`(single character).
    *   **Filter by Extensions:** Optionally filter by a comma-separated list of extensions(e.g., `.png, .jpeg`).
    *   **Number Filter:** Filter files based on the last number found in their names(e.g., `photo_001.jpg` to `photo_100.jpg`). Set lowest/highest to 0 to disable.
    *   **Recursive Scan:** Include subdirectories in the scan.
*   **Manual File Selection:**
    *   **Add Files:** Manually add specific files from any location using a file dialog or by drag & dropping files onto the application.
    *   **Manage List:** Remove selected files or clear the entire list.
    *   The preview list displays an index for each file.

### 2. Renaming Engine

*   **New Naming Pattern:** Construct new filenames using placeholders(see [Available Placeholders](#available-placeholders)).
*   **Find and Replace:**
    *   Search for text within the filename generated by the Naming Pattern.
    *   Replace found text with specified content.
    *   Option for case-sensitive or case-insensitive find.
*   **Change Case:**
    *   Apply case conversion to the filename stem(part before extension):
        *   `No Change`
        *   `UPPERCASE`
        *   `lowercase`
*   **Increment By:**
    *(Primarily for Directory Scan mode with the `<num>` placeholder) Specifies a value to add to numbers parsed from filenames. Can be positive or negative.

### 3. Safety and Convenience

*   **Preview Rename:**
    *   Scans files and applies all defined options to show proposed "Old Name" -> "New Name" changes.
    *   The "Perform Rename" button is enabled only after a successful preview with files to rename.
    *   The Log window shows details, warnings(e.g., potential overwrites), or errors.
*   **Perform Rename:**
    *   Executes the rename operations shown in the preview list after user confirmation.
*   **Create Backup:**
    *   If checked, the entire source directory(target directory in Dir Scan mode, or parent of the first file in Manual mode) is copied to a timestamped backup folder before renaming.
    *   Backup Location: `Your Documents\RenameUtilityBackups\RenameBackup_<Context>_<Timestamp>`.
    *   If backup fails, renaming is aborted.
*   **Undo Last Rename(Ctrl+Z):**
    *   Reverts the immediately preceding successful rename operation.
    *   Relies on renaming files back to their original names recorded during the rename; it does not use the backup.
    *   This feature becomes unavailable after other actions(new preview, mode change, etc.).
*   **Profiles:**
    *   **Save Profile:** Save current settings(mode, paths, patterns, options) under a chosen name.
    *   **Load Profile:** Load previously saved settings.
    *   **Delete Profile:** Remove a saved profile.
*   **Drag & Drop:**
    *   Drop a single directory onto the application to set it as the "Target Directory"(in Directory Scan mode).
    *   Drop one or more files onto the application to add them to the list(in Manual File Selection mode).
*   **Detailed Logging:**
    *   A log panel displays information about initialization, filters, files found/skipped, warnings, errors, backup status, rename results, and undo results.
*   **Input Validation:**
    *   Input fields are validated, and errors are highlighted(e.g., red background).
*   **Filename Sanitization:**
    *   Generated filenames are automatically sanitized to remove characters invalid for Windows filenames(e.g., `\ / : * ? " < > |`).
*   **Responsive UI:**
    *   Preview, rename, and undo operations are performed in background threads to prevent UI freezing.
*   **DPI Awareness:**
    *   On Windows, the application enables per-monitor DPI awareness for sharp UI rendering on high-DPI displays.
*   **Settings Persistence:**
    *   Window size, position, and last used input values are automatically saved on exit and loaded on startup.

### 4. Menu

*   **File:**
    *   `Save Profile...`
    *   `Load Profile...`
    *   `Delete Profile...`
    *   `Undo Last Rename`(Ctrl+Z)
    *   `Exit`
*   **Help:**
    *   `Help...`(F1): Opens a detailed help dialog within the application.
    *   `About...`: Shows application information, version, author, and license.

## Available Placeholders

The "New Naming Pattern" field supports the following placeholders:

**Common(Both Modes):**
*   `<orig_name>`: The original filename without the extension.
*   `<ext>` or `<orig_ext>`: The original file extension(including the dot, e.g., `.jpg`).
*   `<YYYY>`: Current year(4 digits).
*   `<MM>`: Current month(01-12).
*   `<DD>`: Current day(01-31).
*   `<hh>`: Current hour(00-23).
*   `<mm>`: Current minute(00-59).
*   `<ss>`: Current second(00-59).

**Directory Scan Mode Only:**
*   `<num>`: The original number parsed from the filename, potentially modified by "Increment By", formatted with leading zeros(width adjusted by filter range or defaults to 2).
*   `<orig_num>`: The original number parsed from the filename, formatted with leading zeros.

**Manual File Selection Mode Only:**
*   `<index>`: The 1-based index of the file in the manual list, formatted with leading zeros to match the total number of files(e.g., `01`, `02`, ... `10` if there are 10 files).

*Placeholders not applicable to the current mode will be replaced with an empty string.*

## Workflow

1.  **Select Operation Mode:** Choose "Directory Scan" or "Manual File Selection".
2.  **Configure Mode-Specific Options:**
    *   **Directory Scan:** Set Target Directory, Filename Pattern, Extension/Number Filters, and Recursive option.
    *   **Manual Selection:** Add files to the list using "Add Files..." or drag & drop.
3.  **Configure Common Renaming Options:**
    *   Enter the "New Naming Pattern" using placeholders.
    *   Optionally, set "Find Text" / "Replace With", "Case Sensitive Find", "Change Case", and "Increment By".
    *   Decide whether to "Create backup before renaming".
4.  **Preview Changes:** Click "Preview Rename".
    *   Examine the "Old Name" -> "New Name" list.
    *   Check the "Log" panel for details, warnings, or errors.
5.  **Perform Rename:** If the preview is satisfactory, click "Perform Rename".
    *   Confirm the operation.
6.  **(Optional) Undo:** If needed, use "File -> Undo Last Rename"(Ctrl+Z) immediately after a successful rename.

## Installing the Application

To use the File Renamer Utility, you can download the installer from the [Releases page](https://github.com/Denizmerty/RenameUtility/releases).

1.  Download the `FileRenamerUtility_vX.X.X_setup.exe` file(where X.X.X is the version number).
2.  Run the downloaded `setup.exe` file.
3.  Follow the on-screen instructions:
    *   You will be prompted to accept the license agreement(GNU General Public License v3.0).
    *   The installer will check for and install the necessary Microsoft Visual C++ Redistributable if it's not already present on your system.
    *   Choose an installation location(defaults to Program Files).
    *   Select if you want a Start Menu folder created.
    *   Optionally, choose to create a desktop icon.
4.  Once the installation is complete, you can launch the File Renamer Utility from the Start Menu or the desktop icon(if created).

The installer is self-contained and includes everything needed to run the application on a compatible Windows system.

## Building from Source

### Prerequisites

*   **Windows Operating System:** This application is developed and optimized for the Windows platform. It has undergone extensive testing on Windows 11, ensuring robust performance across its features. This includes verification of UI responsiveness, correct handling of complex file system operations(like recursive scanning and renaming across different drives where applicable), reliable backup and undo mechanisms, and accurate DPI scaling on high-resolution displays. The application's core logic, encapsulated in `RenamerLogic`, has passed a comprehensive suite of unit tests on Windows 11, covering plan calculation, rename execution, backup creation, undo operations, and various utility functions(such as wildcard-to-regex conversion, number parsing, and placeholder replacement). These tests confirm the stability and correctness of the renaming engine under diverse scenarios. While in the future I am thinking to release it for cross-platform compatibility with versions for Linux and macOS, the current release is exclusively designed and supported for Windows environments.
*   **Visual Studio:** The project is configured for v143 toolset(Visual Studio 2022 recommended).
*   **wxWidgets:** Version 3.2.2.1.
    *   Download and build wxWidgets.
    *   Set the `WXWIN` environment variable to your wxWidgets installation directory(e.g., `C:\Libraries\wxWidgets-3.2.2.1`).

### Build Steps

1.  Clone the repository or download the source code.
2.  Ensure `WXWIN` environment variable is correctly set.
3.  Open `RenameUtility.sln` in Visual Studio.
4.  Select a build configuration(e.g., `Release | x64`).
5.  Build the solution(Build -> Build Solution).
    *   The executable will typically be found in a subdirectory like `x64\Release`.


## Project Structure

The project is organized into several C++ source(`.cpp`) and header(`.h`) files:

*   `App.*`: Application entry point and initialization.
*   `MainFrame.*`: Core UI, event handling, and main application window logic. Further split into:
    *   `MainFrame_Init.cpp`: Constructor, UI element creation, layout.
    *   `MainFrame_Events.cpp`: Event handlers for menu items, mode changes, button clicks.
    *   `MainFrame_DnD.cpp`: Drag and Drop implementation.
    *   `MainFrame_Threads.cpp`: Handlers for worker thread completion events.
    *   `MainFrame_UI.cpp`: UI update helpers(status bar, input backgrounds, mode changes).
    *   `MainFrame_Profiles.cpp`: Profile saving/loading logic.
    *   `MainFrame_Settings.cpp`: Application settings persistence.
    *   `MainFrame_Undo.cpp`: Undo command handler and state management.
*   `RenamerLogic.*`: Business logic for file scanning, renaming calculations, execution, backup, and undo. Further split into:
    *   `RenamerLogic_Plan.cpp`: Logic for calculating the rename plan.
    *   `RenamerLogic_Execute.cpp`: Logic for performing the actual rename operations.
    *   `RenamerLogic_Backup.cpp`: Logic for creating and managing backups.
    *   `RenamerLogic_Undo.cpp`: Logic for performing the undo operation.
    *   `RenamerLogic_Utils.cpp`: Utility functions(regex, string manipulation, etc.).
*   `WorkerThread.*`: Implements `wxThread` for performing background tasks(preview, rename, undo).
*   `HelpDialog.*`: Custom dialog for displaying help content.
*   `resource.h`, `Resource.rc`: For the application icon.
*   `RenameUtility.sln`, `RenameUtility.vcxproj`: Visual Studio solution and project files.


## Contributing

Contributions are welcome! Please feel free to submit pull requests or open issues for bugs, feature requests, or improvements.

## Contact

For questions, suggestions, or issues, please open an issue on GitHub or contact me at [denizmerty@gmail.com](mailto:denizmerty@gmail.com).

## License

This program is licensed under the **GNU General Public License v3.0**.